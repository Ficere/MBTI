# MBTI 性格测试

一个基于 React + Vite 的 MBTI 性格测试应用，包含 93 道标准测试题目。

## ✨ 新特性（v2.0）

### 🎯 5 选项答题系统
- **更精确的测试**：从传统的二选一升级为 5 选项（完全A、偏向A、中立、偏向B、完全B）
- **权重计算**：每个选项有不同的权重（1.0, 0.75, 0.5, 0.25, 0.0），使结果更科学
- **灵活表达**：允许表达"两者都有"的情况，减少强迫选择
- **向后兼容**：自动识别旧数据，用户无需重新测试

### 📱 小程序支持
- **跨平台**：基于 Taro 框架，支持微信小程序
- **代码共享**：网页版和小程序版共享核心计算逻辑
- **二维码分享**：网页版和小程序版都支持二维码分享

### 🔧 代码重构
- **模块化设计**：提取通用计算逻辑，减少重复代码 ~60%
- **清晰的目录结构**：constants、utils/mbti、utils/helpers 分离
- **易于维护**：单一职责原则，每个文件功能明确

## 功能特点

### ✨ 核心功能
- **完整测试流程**：93 道精心设计的 MBTI 测试题目
- **5 选项答题**：完全A、偏向A、中立、偏向B、完全B（支持权重计算）
- **实时进度显示**：清晰的进度条和题号提示
- **支持返回上一题**：可以修改之前的答案
- **详细结果分析**：展示四个维度的详细得分和百分比（支持小数）
- **示例结果展示**：虚拟人物"李明"的测试结果示例，帮助用户了解结果页面
- **键盘快捷键**：支持 1-5 数字键快速选择，← 返回上一题
- **数据持久化**：自动保存答题进度，刷新页面不丢失
- **历史记录**：保存所有测试结果，可随时查看历史记录
- **结果分享**：下载结果图片、复制文本、生成二维码
- **移动端优化**：响应式设计，完美支持手机和平板

### 📊 结果展示
测试完成后，会显示：
1. **MBTI 类型**：如 INTJ、ENFP 等 16 种性格类型之一
2. **四个维度的详细分析**：
   - **E/I (外向/内向)**：能量来源
   - **S/N (实感/直觉)**：认知方式
   - **T/F (思考/情感)**：判断方式
   - **J/P (判断/感知)**：生活方式

3. **每个维度显示**：
   - 具体得分（选择该选项的题目数量）
   - 百分比（该选项占该维度总题数的比例）
   - 可视化进度条
   - 倾向性说明

## 技术栈

### 网页版
- **React 18**：UI 框架
- **Vite**：构建工具
- **CSS3**：样式设计（渐变色、动画效果）
- **html2canvas**：结果图片生成
- **qrcode**：二维码生成

### 小程序版
- **Taro 4.0**：跨平台框架
- **React**：组件开发
- **Sass**：样式预处理

## 快速开始

### 网页版

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 启动开发服务器（智能模式 - 自动检测并关闭已有实例）
npm run dev:safe

# 构建生产版本
npm run build

# 预览生产版本
npm run preview
```

### 小程序版

```bash
# 进入小程序目录
cd miniapp

# 安装依赖
npm install

# 开发微信小程序
npm run dev:weapp

# 构建微信小程序
npm run build:weapp
```

然后在微信开发者工具中打开 `miniapp/dist` 目录。

## 项目结构

### 网页版

```plaintext
MBTI/
├── src/
│   ├── components/               # 页面组件
│   │   ├── WelcomePage.jsx       # 欢迎页面（含二维码）
│   │   ├── TestPage.jsx          # 测试页面（5选项UI）
│   │   ├── ResultPage.jsx        # 结果页面（权重计算）
│   │   ├── DemoPage.jsx          # 示例结果页面
│   │   └── HistoryPage.jsx       # 历史记录页面
│   ├── constants/                # ✨ 常量配置
│   │   ├── options.js            # 答题选项配置（5选项权重）
│   │   └── mbti/                 # MBTI 类型和维度定义（模块化）
│   │       ├── index.js          # 统一导出
│   │       ├── dimensions.js     # 维度定义
│   │       └── types/            # 16个类型描述文件
│   ├── utils/                    # 工具函数
│   │   ├── mbti/                 # ✨ MBTI 核心逻辑
│   │   │   ├── calculator.js     # 计算逻辑（支持权重）
│   │   │   └── index.js          # 统一导出
│   │   ├── helpers.js            # ✨ 通用辅助函数
│   │   └── storage.js            # 数据持久化
│   ├── data/
│   │   └── questions.json        # 93 道测试题目数据
│   ├── App.jsx                   # 主应用组件
│   └── main.jsx                  # 应用入口
├── docs/                         # 📚 文档
│   ├── 重构总结.md               # 重构说明
│   ├── 5选项使用说明.md          # 用户使用指南
│   ├── 部署说明.md               # 部署指南
│   └── 小程序开发指南.md         # 小程序开发文档
├── miniapp/                      # 📱 小程序版本
│   ├── src/
│   │   ├── pages/                # 小程序页面
│   │   ├── constants/            # 常量配置（与网页版共享）
│   │   ├── utils/                # 工具函数（与网页版共享）
│   │   └── data/                 # 题目数据
│   └── project.config.json       # 小程序配置
├── index.html                    # HTML 模板
├── vite.config.js                # Vite 配置
└── package.json                  # 项目配置
```

## 计分逻辑（v2.0 权重系统）

### 5 选项权重

| 选项 | 权重 | A 得分 | B 得分 | 说明 |
|------|------|--------|--------|------|
| 😄 完全A | 1.0 | 1.0 | 0.0 | 100% 倾向 A |
| 🙂 偏向A | 0.75 | 0.75 | 0.25 | 75% 倾向 A，25% 倾向 B |
| 😐 中立 | 0.5 | 0.5 | 0.5 | 50% 倾向 A，50% 倾向 B |
| 🙁 偏向B | 0.25 | 0.25 | 0.75 | 25% 倾向 A，75% 倾向 B |
| 😞 完全B | 0.0 | 0.0 | 1.0 | 100% 倾向 B |

### 数据格式

```javascript
// 新格式（v2.0）：包含权重
[
  { questionId: 1, value: 'E', weight: 0.75 },
  { questionId: 2, value: 'I', weight: 1.0 },
  ...
]

// 旧格式（v1.0）：简单字符串（自动兼容，默认权重 1.0）
['E', 'I', 'N', 'S', ...]
```

### 计算过程

1. **统计各维度得分**：根据权重累加得分
   - 例如：选择"偏向E"（权重 0.75）→ E 得 0.75 分，I 得 0.25 分
2. **计算百分比**：
   - 每个维度的总分 = 该维度两个选项的得分之和
   - 百分比 = (该选项得分 / 维度总分) × 100%
3. **确定类型**：每个维度选择得分较高的一方
4. **生成 MBTI 类型**：组合四个维度的结果

### 计算示例

假设 E/I 维度有 23 题，用户选择：
- 10 题选择 **😄 完全E**（权重 1.0）
- 5 题选择 **🙂 偏向E**（权重 0.75）
- 3 题选择 **😐 中立**（权重 0.5）
- 3 题选择 **🙁 偏向I**（权重 0.25）
- 2 题选择 **😞 完全I**（权重 0.0）

**计算**：
```
E 得分 = 10×1.0 + 5×0.75 + 3×0.5 + 3×0.25 + 2×0.0 = 16.0 分
I 得分 = 10×0.0 + 5×0.25 + 3×0.5 + 3×0.75 + 2×1.0 = 7.0 分
总分 = 16.0 + 7.0 = 23.0 分

E 百分比 = (16.0 / 23.0) × 100% = 69.6%
I 百分比 = (7.0 / 23.0) × 100% = 30.4%
```

**结果**：倾向于 **外向 (E)**，占 69.6%

## 界面设计

- **渐变背景**：紫色渐变营造专业氛围
- **卡片式设计**：白色卡片提升可读性
- **响应式布局**：支持移动端和桌面端
- **动画效果**：按钮悬停、进度条过渡等交互反馈

## 🎯 使用方法

### 网页版使用

1. **访问** http://localhost:5173（开发模式）或部署后的网址
2. **欢迎页面**：
   - 点击"🚀 开始测试"开始新测试
   - 点击"👁️ 查看示例结果"查看虚拟人物的测试结果
   - 点击"📊 查看历史记录"查看所有测试记录
   - 扫描二维码访问网页版
3. **答题过程**（5 选项）：
   - 先查看选项 A 和选项 B 的描述
   - 选择你的倾向程度：
     - 😄 完全A - 完全符合选项 A
     - 🙂 偏向A - 比较符合选项 A
     - 😐 中立 - 两者都有
     - 🙁 偏向B - 比较符合选项 B
     - 😞 完全B - 完全符合选项 B
   - 键盘快捷键：1-5 数字键选择，← 返回上一题
   - 进度自动保存，刷新页面可继续
4. **查看结果**：
   - 自动显示详细的性格分析（支持权重计算）
   - 点击"📥 下载结果图片"保存结果
   - 点击"📋 复制结果文本"分享结果
   - 点击"📱 分享二维码"生成分享二维码
5. **历史记录**：
   - 所有测试结果自动保存在本地（最多 50 条）
   - 可随时查看、删除历史记录

### 小程序使用

1. 在微信开发者工具中打开 `miniapp/dist` 目录
2. 填入你的小程序 AppID（在 `miniapp/project.config.json` 中）
3. 点击"编译"运行小程序
4. 使用方式与网页版相同

## 开发说明

### 修改题目

编辑 `src/data/questions.json` 文件，格式如下：

```json
{
  "id": 1,
  "question": "问题内容",
  "choice_a": {
    "value": "E",
    "text": "选项A的文本"
  },
  "choice_b": {
    "value": "I",
    "text": "选项B的文本"
  }
}
```

### 修改选项配置

编辑 `src/constants/options.js` 调整选项权重、标签、颜色等。

### 自定义样式

- 修改 `src/App.css` 调整整体布局
- 修改 `src/components/TestPage.css` 调整测试页面样式
- 修改 `src/components/ResultPage.css` 调整结果页面样式

### 修改 MBTI 类型描述

编辑 `src/constants/mbti/types/` 目录下的对应类型文件（如 `INTJ.js`）。

或者编辑 `src/constants/mbti/dimensions.js` 修改维度定义。

## 📚 文档

- [重构总结](docs/重构总结.md) - 详细的重构说明
- [5选项使用说明](docs/5选项使用说明.md) - 用户使用指南
- [部署说明](docs/部署说明.md) - 网页版和小程序部署指南
- [小程序开发指南](docs/小程序开发指南.md) - 小程序开发文档

## 🎉 更新日志

### v2.0.0 (2026-01-21)

- ✨ 新增 5 选项答题系统（完全A、偏向A、中立、偏向B、完全B）
- ✨ 新增权重计算系统（0.0 - 1.0）
- ✨ 新增小程序版本（基于 Taro 框架）
- ✨ 新增二维码分享功能
- 🔧 重构代码结构（constants、utils/mbti、utils/helpers）
- 🔧 提取通用计算逻辑，减少重复代码 ~60%
- 📝 完善文档（重构总结、5选项使用说明、部署说明、小程序开发指南）
- ♻️ 向后兼容旧数据格式

### v1.0.0

- 初始版本
- 93 道 MBTI 测试题目
- 二选一答题系统
- 结果分析和历史记录

## 📄 License

MIT
