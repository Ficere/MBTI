# MBTI 应用部署说明

## 📱 网页版部署

### 当前状态
- ✅ 已添加二维码分享功能
- ✅ ResultPage 可生成分享二维码
- ✅ WelcomePage 显示访问二维码（`http://afel1408710.bohrium.tech:50005/`）

### 部署步骤

#### 1. 构建生产版本
```bash
npm run build
```

#### 2. 部署到服务器
将 `dist` 目录上传到服务器：

```bash
# 使用 scp 上传
scp -r dist/* root@bohrium-2239719-1397249:/opt/MBTI/dist/

# 或使用 rsync
rsync -avz dist/ root@bohrium-2239719-1397249:/opt/MBTI/dist/
```

#### 3. 配置 Nginx（如果使用）
```nginx
server {
    listen 50005;
    server_name afel1408710.bohrium.tech;
    
    root /opt/MBTI/dist;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

#### 4. 启动服务
```bash
# 如果使用 npm run preview
cd /opt/MBTI
npm run preview -- --port 50005 --host 0.0.0.0
```

---

## 📱 小程序部署

### 前置准备

#### 1. 注册微信小程序账号
1. 访问 [微信公众平台](https://mp.weixin.qq.com/)
2. 点击"立即注册" → 选择"小程序"
3. 填写账号信息（需要邮箱验证）
4. 完成主体信息登记（个人或企业）
5. 获取 AppID（在"开发" → "开发管理" → "开发设置"中）

#### 2. 下载微信开发者工具
1. 访问 [微信开发者工具下载页](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
2. 下载对应系统版本
3. 安装并登录（使用微信扫码）

### 开发步骤

#### 1. 完成剩余页面开发
参考 `小程序开发总结.md` 中的待办事项：
- [ ] pages/test (测试页)
- [ ] pages/result (结果页)
- [ ] pages/history (历史记录页)

#### 2. 安装依赖
```bash
cd miniapp
npm install
```

#### 3. 配置 AppID
修改 `miniapp/project.config.json`：
```json
{
  "appid": "你的小程序AppID"
}
```

#### 4. 本地开发测试
```bash
npm run dev:weapp
```

在微信开发者工具中：
1. 点击"导入项目"
2. 项目目录选择：`miniapp/dist`
3. AppID：填入你的小程序 AppID
4. 项目名称：MBTI 性格测试

#### 5. 真机调试
1. 在微信开发者工具中点击"预览"
2. 使用微信扫码
3. 在手机上测试所有功能

### 发布步骤

#### 1. 构建生产版本
```bash
cd miniapp
npm run build:weapp
```

#### 2. 上传代码
在微信开发者工具中：
1. 点击右上角"上传"按钮
2. 填写版本号（如 `1.0.0`）
3. 填写项目备注（如 `初始版本，包含测试和历史记录功能`）
4. 点击"上传"

#### 3. 提交审核
登录 [微信公众平台](https://mp.weixin.qq.com/)：

1. 进入"版本管理"
2. 找到刚上传的版本
3. 点击"提交审核"
4. 填写审核信息：

**基本信息：**
- 小程序名称：MBTI 性格测试
- 小程序简介：专业的 MBTI 性格测试工具，帮助你了解自己的性格类型
- 服务类目：工具 → 问卷调查

**功能页面：**
- 首页：pages/index/index
- 测试页：pages/test/test
- 结果页：pages/result/result
- 历史记录：pages/history/history

**测试账号：**
- 无需登录，直接使用

**隐私政策：**
- 本小程序不收集用户个人信息
- 测试数据仅存储在本地

#### 4. 等待审核
- 审核时间：通常 1-7 个工作日
- 可在"版本管理"中查看审核进度
- 如被驳回，根据反馈修改后重新提交

#### 5. 发布上线
审核通过后：
1. 在"版本管理"中找到审核通过的版本
2. 点击"发布"按钮
3. 确认发布

发布成功后，用户即可在微信中搜索并使用你的小程序！

---

## 🎯 二维码使用说明

### 网页版二维码

#### 1. 分享测试结果（ResultPage）
- **位置**：测试结果页面
- **触发**：点击"📱 分享二维码"按钮
- **功能**：生成当前结果页面的二维码
- **用途**：分享给好友，好友扫码可查看你的测试结果

#### 2. 访问网页版（WelcomePage）
- **位置**：欢迎页面底部
- **链接**：`http://afel1408710.bohrium.tech:50005/`
- **功能**：固定显示的二维码
- **用途**：扫码在手机上打开网页版应用

### 小程序二维码

小程序发布后，可以在微信公众平台获取小程序码：

1. 登录微信公众平台
2. 进入"设置" → "基本设置"
3. 下载小程序码
4. 可用于宣传推广

---

## 📊 功能对比

| 功能 | 网页版 | 小程序版 |
|------|--------|----------|
| MBTI 测试 | ✅ | ✅ |
| 结果展示 | ✅ | ✅ |
| 历史记录 | ✅ | ✅ |
| 数据持久化 | ✅ localStorage | ✅ Storage API |
| 键盘快捷键 | ✅ A/B, 1/2, ← | ❌ 不支持 |
| 下载结果图片 | ✅ html2canvas | ❌ 使用截图 API |
| 二维码分享 | ✅ | ❌ 使用原生分享 |
| 微信分享 | ❌ | ✅ 原生支持 |
| 离线使用 | ❌ | ✅ 支持 |
| 桌面访问 | ✅ | ❌ |
| 移动访问 | ✅ | ✅ |

---

## 🔧 常见问题

### Q1: 小程序审核被驳回怎么办？
**A:** 根据驳回原因修改：
- 如果是功能问题，完善功能后重新提交
- 如果是资质问题，补充相关资质证明
- 如果是内容问题，修改文案和图片

### Q2: 网页版二维码无法访问？
**A:** 检查：
- 服务器是否正常运行
- 端口 50005 是否开放
- 域名解析是否正确
- 防火墙设置

### Q3: 小程序如何更新？
**A:** 
1. 修改代码
2. 构建新版本
3. 上传新版本（版本号递增）
4. 提交审核
5. 审核通过后发布

### Q4: 如何推广小程序？
**A:**
- 下载小程序码，用于线下宣传
- 在公众号文章中插入小程序卡片
- 在朋友圈分享小程序
- 在社交媒体推广

---

## 📞 技术支持

如有问题，请查阅：
- `小程序开发指南.md` - 详细开发指南
- `小程序开发总结.md` - 已完成工作和待办事项
- `miniapp/README.md` - 快速开发指南

祝部署顺利！🎉

